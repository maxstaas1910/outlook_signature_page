<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/grids-responsive-min.css" />
    <link rel="icon" href="https://cdn-assets-eu.frontify.com/s3/frontify-enterprise-files-eu/eyJwYXRoIjoib3R0b1wvYWNjb3VudHNcL2U3XC80MDAwNDYxXC9wcm9qZWN0c1wvMTFcL2Fzc2V0c1wvYjNcLzU1NTRcL2U2ODgwMDAzNjNkN2IzNWQxZWI4MjQzOTA4MmFmODJhLTE1ODAyMjIwMzAuc3ZnIn0:otto:otWJxJkDsq4Hwi0veWgyTvLU80QPOHpTC3XDx2HaSPw?width=2400">
    <title>Outlook Signature Tool</title>
</head>
<body >
<div>
    <div class="inputbox" id="inputbox">
        <div class="content">
            <div id="languagebuttons" class="languagebuttons">
                <button id="germanbutton" title="German Page" class="languagebutton" onclick="setLanguage('german')">&#x1F1E9;&#x1F1EA;</button>
                <button id="englishbutton" title="English Page" class="languagebutton" onclick="setLanguage('english')">&#x1F1EC;&#x1F1E7;</button>
            </div>
            <div style="text-align:center">
                <h2 class="german"><span style="color: #D4021D">OTTO</span> Signatur erstellen oder aktualisieren</h2>
                <h2 class="english">Create or update <span style="color: #D4021D">OTTO</span> signature</h2>
            </div>
            <form id="inputfields" class="pure-form pure-form-stacked">
                <fieldset>
                    <legend class="german" style="display: none;">Deine Daten prüfen und anpassen</legend>
                    <legend class="english" style="display: none;">Check and adjust your data</legend>
                    <div class="pure-g">
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="firstnameger" class="german" style="display: none;">Vorname</label>
                            <label for="firstnameen" class="english" style="display: none;">Firstname</label>
                            <input id="firstnameger" class="german" type="text" style="width:99%; display: none" placeholder="Max" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input id="firstnameen" class="english" type="text" style="width:99%; display: none" placeholder="John" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="surnameger" class="german" style="display: none;">Nachname</label>
                            <label for="surnameen" class="english" style="display: none;">Surname</label>
                            <input type="text" id="surnameger" class="german" style="width:99%; display: none" placeholder="Mustermann" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input type="text" id="surnameen" class="english" style="width:99%; display: none" placeholder="Doe" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="positionger" class="german" style="display: none;">Position</label>
                            <label for="positionen" class="english" style="display: none;">Title</label>
                            <input type="text" id="positionger" class="german" style="width:99%; display: none" placeholder="Praktikant" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input type="text" id="positionen" class="english" style="width:99%; display: none" placeholder="Intern" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="departmentger" class="german" style="display: none;">Abteilung</label>
                            <label for="departmenten" class="english" style="display: none;">Department</label>
                            <input type="text" id="departmentger" class="german" style="width:99%; display: none" placeholder="Kommunikation" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input type="text" id="departmenten" class="english" style="width:99%; display: none" placeholder="Communications" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="departmentidger" class="german" style="display: none;">Abteilungskürzel</label>
                            <label for="departmentiden" class="english" style="display: none;">Department ID</label>
                            <input type="text" id="departmentidger" class="german" style="width:99%; display: none" placeholder="VV-WK" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input type="text" id="departmentiden" class="english" style="width:99%; display: none" placeholder="VV-WK" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="phonenrger" class="german" style="display: none;">Telefonnummer</label>
                            <label for="phonenren" class="english" style="display: none;">Phone-number</label>
                            <input type="text" id="phonenrger" class="german" style="width:99%; display: none" placeholder="+49 (40) 6461 XXXX" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input type="text" id="phonenren" class="english" style="width:99%; display: none" placeholder="+49 (40) 6461 XXXX" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="mobilenrger" class="german" style="display: none;">Mobilnummer</label>
                            <label for="mobilenren" class="english" style="display: none;">Mobile-number</label>
                            <input type="text" id="mobilenrger" class="german" style="width:99%; display: none" placeholder="0160 XXX XXX XXX" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input type="text" id="mobilenren" class="english" style="width:99%; display: none" placeholder="0160 XXX XXX XXX" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2">
                            <label for="emailger" class="german" style="display: none;">Email-Adresse</label>
                            <label for="emailen" class="english" style="display: none;">Email-address</label>
                            <input type="text" id="emailger" class="german" style="width:99%; display: none" placeholder="max.mustermann@otto.de" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                            <input type="text" id="emailen" class="english" style="width:99%; display: none" placeholder="john.doe@otto.de" oninput="updatePreview()" onchange="saveToLocalStorage()"/>
                        </div>
                        <div class="pure-u-1 pure-u-md-1-2" style="text-align: center">
                            <label for="buttons"></label><br>
                            <button type="button" id="buttons" class="pure-button german" style="display: none" onclick="copyToClip()">In die Zwischenablage kopieren</button>
                            <button type="button" class="pure-button german" style="display: none" onclick="toggleHelpVisibility()">Hilfe</button>
                            <button type="button" class="pure-button english" style="display: none" onclick="copyToClip()">Copy to clipboard</button>
                            <button type="button" class="pure-button english" style="display: none" onclick="toggleHelpVisibility()">Help</button>
                        </div>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
    <div class="outputbox" id="outputbox" style="margin-top: 1%;">
        <h2 class="german" >Signatur:</h2>
        <h2 class="english" >Signature:</h2>
        <div class="preview">
            <form id="outputfield" class="pure-form" style="word-wrap: break-word;">
            </form>
        </div>
    </div>
    <div id="help" class="help">
        <button id="close" onclick="toggleHelpVisibility()">&times;</button>
        <div class="german" style="display:none">
            <h2>Nutzungsanleitung</h2>
            <p>
                1. Persönliche Daten eintragen. Bei Freilassen des Fax-, Telefon-, oder Mobilnummer-Feldes wird die dazugehörige Zeile aus der Signatur entsprechend angepasst. Bei Freilassen des Email-Feldes wird diese aus Vor- und Nachname automatisch generiert.<br>
            </p>
            <p>
                2. Durch Klicken des "In die Zwischenablage kopieren" Knopfes befindet sich die Signatur nun in der Zwischenablage und kann zu den Outlook-Signaturen hinzugefügt werden. <br>
            </p>
            <p>
                3. Outlook über einen Browser öffnen. <br>
            </p>
            <p>
                4. Oben Rechts auf das Zahnrad und danach auf "Alle Outlook-Einstellungen anzeigen" klicken. <br>
            </p>
            <p>
                5. In der linken Leiste erst das Feld "E-Mail" und danach das Feld "Verfassen und Antworten" auswählen. <br>
            </p>
            <p>
                6. Auf "+ Neue Signatur" klicken. Nun kann der Signatur im ersten Feld einen Namen gegeben werden. Im zweiten Feld kann nun die zuvor erzeugte Signatur mit Drücken von STRG und V oder mit einem Rechtsclick gefolgt von einem Klick auf "Einfügen" hinzugefügt werden.<br>
            </p>
            <p>
                7. Unter dem Eingabefeld kann die Signatur nun als Standardsignatur für neue Nachrichten sowie Antworten und Weiterleitungen festgelegt werden.<br>
            </p>
            <p>
                8. Mit Betätigung des "Speichern"-Knopfes am unteren rechten Rand des Fensters wird nun die neue Signatur gespeichert.
            </p>
        </div>
        <div class="english" style="display: none">
            <h2>Instructions</h2>
            <p>
                1. Enter personal data. If fax-, phone- or mobile-number fields are left empty, the corresponding line in signature will be adjusted accordingly. If email-field is left empty, it will be generated from first and last name.<br>
            </p>
            <p>
                2. After clicking "Copy to clipboard" button, the generated signature is now in clipboard and can be added to outlook signatures.<br>
            </p>
            <p>
                3. Open Outlook.<br>
            </p>
            <p>
                4. In outlook, click the gear icon in the top right and press "View all Outlook Settings".<br>
            </p>
            <p>
                5. In the left bar click the field "Mail" and afterwards the field "Compose and reply".<br>
            </p>
            <p>
                6. Click on "+ New Signature". Now the signature can be named by typing into the first textfield. The generated signature can now be inserted into the second textbox by simultaneously pressing CTRL and V or by rightclicking the textbox and selecting "insert".<br>
            </p>
            <p>
                7. Underneath the input fields signature can now be selected as the standard signature for new and forwarded messages aswell as replies.<br>
            </p>
            <p>
                8. By pressing "save"-button in the bottom right corner, the new signature will be saved.
            </p>
        </div>
    </div>
</div>
<script>

// global constants holding the language specific strings: [name for telefax, name for telefax, name for mobilenumber,
// rich string with otto signature details, plain string with otto signature details]
const germanStrings = ["Telefon", "Mobiltelefon",
    "AG Hamburg, HR A 62 024, Persönlich haftend: Verwaltungsgesellschaft Otto GmbH," +
    "<br>Hamburg, AG Hamburg, HR B 13 762 vertr. durch: Alexander Birken (Vorsitzender)" +
    "<br>Dr. Marcus Ackermann • Sergio Bucher • Sebastian Klauke • Petra Scharner-Wolff • " +
    "Kay Schiebur<br><br>" +
    "Aufsichtsrat: Prof. Dr. Michael Otto (Vorsitzender)<br></span><span style='font-size:10.0pt; " +
    "font-family:&quot;Arial&quot;,sans-serif; color:black'>",
    "\n\nAG Hamburg, HR A 62 024, Persönlich haftend: Verwaltungsgesellschaft Otto GmbH," +
    "\nHamburg, AG Hamburg, HR B 13 762 vertr. durch: Alexander Birken (Vorsitzender)" +
    "\nDr. Marcus Ackermann • Sergio Bucher • Sebastian Klauke • Petra Scharner-Wolff • Kay Schiebur" +
    "\n\nBereichsvorstände OTTO: Marc Opelt (Vorsitzender) • Bodo Kipper\nDr. Michael Müller-Wünsch • " +
    "Katy Roewer (jeweils Handlungsbevollmächtigte)\n\nAufsichtsrat: Prof. Dr. Michael Otto (Vorsitzender)" +
    "\n", "Signatur erfolgreich in Zwischenablage kopiert!"];
const englishStrings = ["Phone", "Mobile",
    "Local court of Hamburg, HR A 62 024, General Partner: Verwaltungsgesellschaft Otto GmbH," +
    "<br>Hamburg, local court of Hamburg, HR B 13 762 represented by: Alexander Birken (Chairman)" +
    "<br>Dr. Marcus Ackermann • Sergio Bucher • Sebastian Klauke • Petra Scharner-Wolff • Kay Schiebur" +
    "<br><br>" +
    "Supervisory Board: Prof. Dr. Michael Otto (Chairman)<br>",
    "Local court of Hamburg, HR A 62 024, General Partner: Verwaltungsgesellschaft Otto GmbH," +
    "\nHamburg, local court of Hamburg, HR B 13 762 represented by: Alexander Birken (Chairman)\n" +
    "Dr. Marcus Ackermann • Sergio Bucher • Sebastian Klauke • Petra Scharner-Wolff • Kay Schiebur\n\n" +
    "Members of the OTTO Management Board: Marc Opelt (Chairman) • Bodo Kipper\n" +
    "Dr Michael Müller-Wünsch • Katy Roewer (special proxy holders)\n\n" +
    "Supervisory Board: Prof. Dr. Michael Otto (Chairman)\n", "Signature copied to clipboard successfully!"];

const fields =  document.getElementById("inputfields");
const browserLanguage = window.navigator.userLanguage || window.navigator.language;
const pageLanguage = getPageLanguage();

// on load fill input fields with locally stored values; make elements in the correct item visible and update the preview
// window with the loaded values for input fields
window.onload = function () {
    for (let i = 0; i< fields.length; i++){
        fields[i].value = localStorage.getItem(fields[i].id);
    }
    toggleLanguage();
    updatePreview();
}

// Saves user input to local storage
function saveToLocalStorage() {
    for (let i = 0; i< fields.length; i++){
        localStorage.setItem(fields[i].id, fields[i].value);
    }
}

// update the preview window at the bottom of page
function updatePreview() {
    document.getElementById("outputfield").innerHTML = generateRichSignature(getFields());
}

// looks at all the input fields on page and collects all fields with the correct language into an array
function getFields() {
    let languageFields = [];
    for (let i = 0; i< fields.length; i++){
        if (fields[i].className == pageLanguage) {
            languageFields.push(fields[i].value);
        }
    }
    return languageFields;
}

function generateRichSignature(fields) {
    return "<span style='font-size:10.0pt; font-family:&quot;Arial&quot;,sans-serif; color:black'> " +
        "___________________________________________________________________" +
        "<br><br>" + fields[0] + " " + fields[1] +  "<br>" + fields[2] + " • "  + fields[3] + " • " + fields[4] +
        "<br><br>Otto (GmbH & Co KG) • Werner-Otto-Straße 1-7 • 22179 Hamburg<br>A member of the Otto Group<br>"
        + checkIfPhoneMobileTelefaxAreSet(fields[5], fields[6], fields[7]) + "<br>" +
        checkIfEmailIsSet(fields[0], fields[1], fields[8]) +
        "<br>___________________________________________________________________<br>" +
        "<br>www.otto.de<br>www.facebook.com/otto<br>www.twitter.com/otto_de<br>" +
        "___________________________________________________________________" +
        "</span><br><br><span style='font-size:8.0pt; font-family:&quot;Arial&quot;,sans-serif; color:black'>"
        + eval(pageLanguage  + "Strings")[2];
}

function generatePlainSignature(fields) {
    return "___________________________________________________________________\n\n" + fields[0] + " " + fields[1] +
        "\n" + fields[2] + " • "  + fields[3] + " • " + fields[4] + "\n\nOtto (GmbH & Co KG) • Werner-Otto-Straße " +
        "1-7 • 22179 Hamburg\nA member of the Otto Group\n" + checkIfPhoneMobileTelefaxAreSet(fields[5], fields[6],
            fields[7]) + "\n" + checkIfEmailIsSet(fields[0], fields[1], fields[8]) +
        "\n___________________________________________________________________\n\nwww.otto.de\nwww.facebook.com/otto" +
        "\nwww.twitter.com/otto_de\n___________________________________________________________________\n\n"
        + eval(pageLanguage  + "Strings")[3];
}

function copyToClip() {
  saveToLocalStorage(getFields());
  function listener(e) {
    e.clipboardData.setData("text/html", generateRichSignature(getFields()));
    e.clipboardData.setData("text/plain", generatePlainSignature(getFields()));
    e.preventDefault();
  }
  document.addEventListener("copy", listener);
  document.execCommand("copy");
  document.removeEventListener("copy", listener);

  alert(eval(pageLanguage + "Strings")[4]);
}

function toggleHelpVisibility() {
    let help = document.getElementById("help");
    let input = document.getElementById("inputbox");
    let output = document.getElementById("outputbox");
    if (help.style.display == "inline") {
        input.style.display = 'block';
        output.style.display = 'block';
        help.style.display = 'none';
    } else {
        help.style.display = 'inline';
        input.style.display = 'none';
        output.style.display = 'none';
    }
}

// Since sometimes not all 3 fields are given, formats the line correctly and causes no doubled or missing "•"
function checkIfPhoneMobileTelefaxAreSet(phonenrField, mobilenrField) {
    let phonenr =  "", mobilenr = "";

    let languageTel = eval(pageLanguage + "Strings")[0];
    let languageMob = eval(pageLanguage + "Strings")[1];

    if (phonenrField) phonenr = languageTel + " " + phonenrField;

    if (mobilenrField && phonenrField) mobilenr = " • " + languageMob + " " + mobilenrField;
    else if (mobilenrField) mobilenr = languageMob + " " + mobilenrField;

    return phonenr + mobilenr;
}

// If email field is empty, generate email from first and surname
function checkIfEmailIsSet(name, surname, emailField) {
    if(emailField){
        return emailField;
    } else {
        return name.toLowerCase() + "." + surname.toLowerCase() + "@otto.de";
    }
}

function setLanguage(newLanguage) {
    localStorage.setItem("language", newLanguage);
    location.reload();
}

// make page elements visible if they have the correct language
function toggleLanguage() {
    let languagecontent = document.getElementsByClassName(pageLanguage);
    for (var i = 0; i < languagecontent.length; i++) {
        languagecontent[i].style.display = "inline";
    }
}

// if user has language in cookie, use that one. If not and user has english browser, page is english. Otherwise display
// page in german
function getPageLanguage() {
    if ((localStorage.getItem("language"))) {
        return localStorage.getItem("language");
    } else if (browserLanguage.slice(0,2)=="en") {
        return "english";
    } else {
        return "german";
    }
}

</script>

<style>

html, body {
    padding: 1em;
    font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 15px;
    color: #777777;
    background-color:  #C4C4C4;
}

.languagebuttons {
    text-align: right;
    font-size:20px;
}
.german, .english {
    display: none;
}

h2 {
    margin-left:auto;
    margin-right:auto;
}

.inputbox, .outputbox {
    max-width: 80%;
    padding: 1em 3em 2em 3em;
    margin: 0em auto;
    background-color: #fff;
    border-radius: 4.2px;
    box-shadow: 0px 3px 10px -2px rgba(0, 0, 0, 0.2);
    display: block;
}

.button-secondary {
    background: rgb(66, 184, 221);
}

.preview{
    text-align: left;
    margin:auto;
    width:50%;
    border:1px solid lightgrey;
    padding: 30px 40px;
    box-shadow: 0px 3px 10px -2px rgba(0, 0, 0, 0.2);
}

.help {
    display: none;
    color: black;
    padding: 30px 40px;
    position: absolute;
    transform: translate(-50%,-50%);
    left: 50%;
    top: 50%;
    max-width: 80%;
    text-align: center;
    margin: 0em auto;
    background-color: #fff;
    border-radius: 4.2px;
    box-shadow: 0px 3px 10px -2px rgba(0, 0, 0, 0.2);
}

.help button{
    display: block;
    margin:  0 0 20px auto;
    cursor: pointer;
}

.help h2{
    margin-top: -20px;
}

.help p{
    font-size: 14px;
    text-align: justify;
    margin: 20px 0;
    line-height: 25px;
}

</style>
</body>
</html>
