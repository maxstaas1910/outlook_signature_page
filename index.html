<!DOCTYPE html>
<html lang="en">
<!--TODO fix help button and style help page-->
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/grids-responsive-min.css" />
    <title>Outlook Signature Tool</title>
</head>
<body>
<div class="inputbox">
    <div class="content">
        <h2>OTTO Signatur erstellen oder aktualisieren</h2>
        <form id="inputfields" class="pure-form pure-form-stacked">
            <fieldset>
                <legend>Deine Daten prüfen und anpassen</legend>
                <div class="pure-g">
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="firstname">Vorname</label>
                        <input type="text" id="firstname" style="width:99%" placeholder="Max" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="surname" >Nachname</label>
                        <input type="text" id="surname" style="width:99%" placeholder="Mustermann" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="position">Position</label>
                        <input type="text" id="position" style="width:99%" placeholder="Praktikant" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="department">Abteilung</label>
                        <input type="text" id="department" style="width:99%" placeholder="Kommunikation" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="departmentid">Abteilungskürzel</label>
                        <input type="text" id="departmentid" style="width:99%" placeholder="VV-WK" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="faxnr">Faxnummer</label>
                        <input type="text" id="faxnr" style="width:99%" placeholder="Faxnnummer" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="phonenr">Telefonnummer</label>
                        <input type="text" id="phonenr" style="width:99%" placeholder="0160 XXX XXX XXX" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="mobilenr">Mobilnummer</label>
                        <input type="text" id="mobilenr" style="width:99%" placeholder="0160 XXX XXX XXX" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2">
                        <label for="email">Email-Adresse</label>
                        <input type="text" id="email" style="width:99%" placeholder="max.mustermann@otto.de" oninput="updateTextArea()"/>
                    </div>
                    <div class="pure-u-1 pure-u-md-1-2" style="text-align: center">
                        <label for="copySignatureButton"><br></label>
                        <button type="button" class="pure-button" id="copySignatureButton" onclick="copySignature()">In die Zwischenablage kopieren</button>
                        <button type="button" class="pure-button" onclick="toggleHelp()">Hilfe</button>
                    </div>
                </div>
            </fieldset>
        </form>
    </div>
</div>
<div class="outputbox" style="margin-top: 1%;">
    <div class="preview" style="text-align: center">
        <h2>Signatur:</h2>
        <form id="outputfield" class="pure-form">
            <textarea rows="17" id="output" style="resize: none; width: 70%" wrap="off" readonly>
            </textarea>
        </form>
    </div>
</div>
<div id="help" class="help">
    <button id="close" onclick="toggleHelp()">&times;</button>
    <h2>Nutzungsanleitung</h2>
    <p>
        1. Persönliche Daten eintragen. Bei Freilassen des Telefax-Feldes wird die dazugehörige Zeile aus der Signatur gelöscht. Bei Freilassen des Email-Feldes wird diese aus Vor- und Nachname automatisch generiert.<br>
    </p>
    <p>
        2. Durch Klicken des "In die Zwischenablage kopieren" Knopfes befindet sich die Signatur nun in der Zwischenablage und kann zu den Outlook-Signaturen hinzugefügt werden. <br>
    </p>
    <p>
        3. Outlook über einen Browser öffnen. <br>
    </p>
    <p>
        4. Oben Rechts auf das Zahnrad und danach auf "Alle Outlook-Einstellungen anzeigen" (Englisch: "View all Outlook Settings") klicken. <br>
    </p>
    <p>
        5. In der linken Leiste erst das Feld "E-Mail" (Englisch: "Mail") und danach das Feld "Verfassen und Antworten" (E: "Compose and reply") auswählen. <br>
    </p>
    <p>
        6. Auf "+ Neue Signatur" ("+ New Signature") klicken. Nun kann der Signatur im ersten Feld einen Namen gegeben werden. Im zweiten Feld kann nun die zuvor erzeugte Signatur mit Drücken von STRG und V oder mit einem Rechtsclick gefolgt von einem Klick auf "Einfügen" hinzugefügt werden.<br>
    </p>
    <p>
        7. Unter dem Eingabefeld kann die Signatur nun als Standardsignatur für neue Nachrichten sowie Antworten und Weiterleitungen festgelegt werden.<br>
    </p>
    <p>
        8. Mit Betätigung des "Speichern"-Knopfes am unteren rechten Rand des Fensters wird nun die neue Signatur gespeichert.
    </p>
</div>

<script>

// load input field contents from local storage
window.onload = function () {
    let fields = document.getElementById("inputfields");
    for (let i = 0; i< fields.length; i++){
        fields[i].value = localStorage.getItem(fields[i].id);
    }
    updateTextArea();
}

// show or hide help box
function toggleHelp() {
    let help = document.getElementById("help");
    if (help.style.display === "none") {
        help.style.display = 'inline';
    } else {
        help.style.display = 'none';
    }
}

// Reads user input, stores it in local storage and inserts the generated signature to clipboard
function copySignature() {
    let fields = document.getElementById("inputfields");
    saveToLocalStorage(fields);

    navigator.clipboard.writeText(generateSignature(fields));
    alert("Signatur wurde erfolgreich in die Zwischenablage kopiert!");
}

function generateSignature(fields) {
    return "___________________________________________________________________\n\n" + fields[1].value + " " + fields[2].value +  "\n" + fields[3].value + " • "  + fields[4].value + " • " + fields[5].value + "\n\nOtto (GmbH & Co KG) • Werner-Otto-Straße 1-7 • 22179 Hamburg\nA member of the Otto Group\n" + checkIfPhoneMobileTelefaxAreSet(fields[6].value, fields[7].value, fields[8].value) + "\n" + checkIfEmailIsSet(fields[1].value, fields[2].value, fields[9].value) + "\n___________________________________________________________________\n\nwww.otto.de\nwww.facebook.com/otto\nwww.twitter.com/otto_de\n___________________________________________________________________\n\nAG Hamburg, HR A 62 024, Persönlich haftend: Verwaltungsgesellschaft Otto GmbH,\nHamburg, AG Hamburg, HR B 13 762 vertr. durch: Alexander Birken (Vorsitzender) • \nDr. Marcus Ackermann • Sergio Bucher • Sebastian Klauke • Petra Scharner-Wolff • Kay Schiebur\n\nBereichsvorstände OTTO: Marc Opelt (Vorsitzender) • Bodo Kipper •\nDr. Michael Müller-Wünsch • Katy Roewer (jeweils Handlungsbevollmächtigte)\n\nAufsichtsrat: Prof. Dr. Michael Otto (Vorsitzender)\n___________________________________________________________________\n\nSAVE PAPER - THINK BEFORE YOU PRINT";
}

function checkIfPhoneMobileTelefaxAreSet(faxField, phonenrField, mobilenrField) {
    // TODO clean this up
    let fax = "", phonenr =  "", mobilenr = "";

    if (phonenrField) phonenr = "Phone " + phonenrField;

    if (faxField && phonenrField && mobilenrField) fax = " • Fax " + faxField + " • ";
    else if (faxField && phonenrField) fax = " • Fax " + faxField;
    else if (faxField && mobilenrField) fax = "Fax " + faxField + " • ";
    else if (faxField) fax = "Fax " + faxField;

    if (mobilenrField && phonenrField && !faxField) mobilenr = " • Mobile " + mobilenrField;
    else if (mobilenrField) mobilenr = "Mobile " + mobilenrField;

    return phonenr + fax + mobilenr;
}

function checkIfEmailIsSet(name, surname, emailField) {
    if(emailField){
        return emailField;
    } else {
        return name.toLowerCase() + "." + surname.toLowerCase() + "@otto.de";
    }
}

function saveToLocalStorage(fields) {
    for (let i = 0; i< fields.length; i++){
        localStorage.setItem(fields[i].id, fields[i].value);
    }
}

function updateTextArea() {
    document.getElementById("output").value = generateSignature(document.getElementById("inputfields"));
}

</script>

<style>

.inputbox, .outputbox {
  max-width: 80%;
  padding: 1em 3em 2em 3em;
  margin: 0em auto;
  background-color: #fff;
  border-radius: 4.2px;
  box-shadow: 0px 3px 10px -2px rgba(0, 0, 0, 0.2);
}

body {
  padding: 1em;
  font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 15px;
  color: #b9b9b9;
  background-color: #e3e3e3;
}

.button-secondary {
            background: rgb(66, 184, 221);
}

.help button{
    display: block;
    margin:  0 0 20px auto;
    cursor: pointer;
}
h2 {
    text-align: center;
}

.help {
    display: none;
    border:1px solid black;
    background-color: #ffffff;
    width: 420px;
    padding: 30px 40px;
    position: absolute;
    transform: translate(-50%,-50%);
    left: 50%;
    top: 50%;
    display: none;
    text-align: center;
}

.help p{
    font-size: 14px;
    text-align: justify;
    margin: 20px 0;
    line-height: 25px;
}

.help h2{
  margin-top: -20px;
}

a {
    display: block;
}
</style>
</body>
</html>
